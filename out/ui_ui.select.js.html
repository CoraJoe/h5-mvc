<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ui/ui.select.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Gom.html">Gom</a></li><li><a href="Gom.App.html">App</a></li><li><a href="Gom.Page.html">Page</a><ul class='methods'><li data-type='method'><a href="Gom.Page.html#destory">destory</a></li><li data-type='method'><a href="Gom.Page.html#getHTMLFragment">getHTMLFragment</a></li><li data-type='method'><a href="Gom.Page.html#getHTMLTmpl">getHTMLTmpl</a></li><li data-type='method'><a href="Gom.Page.html#render">render</a></li><li data-type='method'><a href="Gom.Page.html#show">show</a></li><li data-type='method'><a href="Gom.Page.html#update">update</a></li></ul></li><li><a href="Gom.Service.html">Service</a></li><li><a href="Gom.UI.html">UI</a></li><li><a href="Gom.UI.Button.html">Button</a><ul class='methods'><li data-type='method'><a href="Gom.UI.Button.html#destory">destory</a></li><li data-type='method'><a href="Gom.UI.Button.html#getHTMLFragment">getHTMLFragment</a></li><li data-type='method'><a href="Gom.UI.Button.html#getHTMLTmpl">getHTMLTmpl</a></li><li data-type='method'><a href="Gom.UI.Button.html#render">render</a></li><li data-type='method'><a href="Gom.UI.Button.html#show">show</a></li><li data-type='method'><a href="Gom.UI.Button.html#update">update</a></li></ul></li><li><a href="Gom.UI.Header.html">Header</a><ul class='methods'><li data-type='method'><a href="Gom.UI.Header.html#destory">destory</a></li><li data-type='method'><a href="Gom.UI.Header.html#getHTMLFragment">getHTMLFragment</a></li><li data-type='method'><a href="Gom.UI.Header.html#getHTMLTmpl">getHTMLTmpl</a></li><li data-type='method'><a href="Gom.UI.Header.html#render">render</a></li><li data-type='method'><a href="Gom.UI.Header.html#show">show</a></li><li data-type='method'><a href="Gom.UI.Header.html#update">update</a></li></ul></li><li><a href="Gom.UI.List.html">List</a><ul class='methods'><li data-type='method'><a href="Gom.UI.List.html#destory">destory</a></li><li data-type='method'><a href="Gom.UI.List.html#getHTMLFragment">getHTMLFragment</a></li><li data-type='method'><a href="Gom.UI.List.html#getHTMLTmpl">getHTMLTmpl</a></li><li data-type='method'><a href="Gom.UI.List.html#render">render</a></li><li data-type='method'><a href="Gom.UI.List.html#show">show</a></li><li data-type='method'><a href="Gom.UI.List.html#update">update</a></li></ul></li><li><a href="Gom.UI.Modal.html">Modal</a></li><li><a href="Gom.UI.Scroll.html">Scroll</a></li><li><a href="Gom.UI.Select.html">Select</a></li><li><a href="Gom.UI.Slide.html">Slide</a></li><li><a href="Gom.UI.Toggle.html">Toggle</a></li><li><a href="Gom.View.html">View</a></li><li><a href="Sides.html">Sides</a></li></ul><h3>Namespaces</h3><ul><li><a href="store.html">store</a><ul class='methods'><li data-type='method'><a href="store.html#.del">del</a></li><li data-type='method'><a href="store.html#.del">del</a></li><li data-type='method'><a href="store.html#.each">each</a></li><li data-type='method'><a href="store.html#.get">get</a></li><li data-type='method'><a href="store.html#.has">has</a></li><li data-type='method'><a href="store.html#.noexpire">noexpire</a></li><li data-type='method'><a href="store.html#.size">size</a></li></ul></li><li><a href="url.html">url</a><ul class='methods'><li data-type='method'><a href="url.html#.getHashPath">getHashPath</a></li><li data-type='method'><a href="url.html#.getHashSearch">getHashSearch</a></li><li data-type='method'><a href="url.html#.getHTML5Hash">getHTML5Hash</a></li><li data-type='method'><a href="url.html#.getParams">getParams</a></li><li data-type='method'><a href="url.html#.getUrl">getUrl</a></li><li data-type='method'><a href="url.html#.set">set</a></li><li data-type='method'><a href="url.html#.setParam">setParam</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#_parseEvent">_parseEvent</a></li><li><a href="global.html#config">config</a></li><li><a href="global.html#events">events</a></li><li><a href="global.html#isback">isback</a></li><li><a href="global.html#isTopBot">isTopBot</a></li><li><a href="global.html#offview">offview</a></li><li><a href="global.html#onview">onview</a></li><li><a href="global.html#params">params</a></li><li><a href="global.html#refreshEvent">refreshEvent</a></li><li><a href="global.html#requirejs">requirejs</a></li><li><a href="global.html#seo">seo</a></li><li><a href="global.html#slideInModal">slideInModal</a></li><li><a href="global.html#title">title</a></li><li><a href="global.html#tmpl">tmpl</a></li><li><a href="global.html#toUrl">toUrl</a></li><li><a href="global.html#widgets">widgets</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">ui/ui.select.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>define(['View', 'Modal', 'Scroll', 'List'], function(View, Modal, Scroll, List) {

    /**
     * 多级联动或是仅多级选择组件
     * @class Gom.UI.Select
     * @alias Select
     * @extend {View}
     * @param {object} opts 参列
     * opts.wrapper {selecot} 当非model弹出时需要此属性，组件将插入到此wrapper
     * opts.data包含以下属性：
            title {string}  title
            level {number} 1 级数
            modal {boolean} 底部弹出选择
            cascade {boolean} true/false 是否级联 （级联表示每级之间有显示联系，无级联如时间选择， 有级联如日期选择）
            className 自定义的class
            yardNo {number} 准绳处于第几行,默认第三行(则可见总共五行)
            list = {'1': [], '2': []};
            onYes(select val);
            onNo();
     * @example 实例一个时间选择器
     * new Select({
            wrapper:
            title: '时间选择器',
            modal: true,    //显示
            cascade: false,
            level: 3,
            data: {'1':['上午','下午'],'2': _.range(1,13), '3': _.range(1,61)},
            onYes: function(val){
                console.log('选择的值为：' + val);
            }
        })
     **/
    var defaults = {
        title: '请选择',
        yardNo: 3,
        modal: true,
    };
    var Select = View.extend({
        init: function(opts){
            var data = opts.data = _.extend({}, defaults, opts.data);
            data.modal = (data.modal === void 0) ? true : data.modal;
            data.className = data.className || '';
            $.extend(this, opts);
            this.tmpl = this.makeScrollCtn();
            this._super(opts);
        },
        show: function(){
            var that = this; data = this.data;
            console.log(this.modal, 'thismodal');
            if(data.modal){
                Modal.bottom({title: data.title, content: this.makeScrollCtn(),
                    onYes: function(){
                        var val = that.getSelect();
                        data.onYes ? data.onYes(val) : null;
                    },
                    onNo: function(){
                        data.onNo ? data.onNo() : null;
                    }});
            }else{
                if(!this.wrapper){
                    console.error('当select没有指向为modal显示时，需要指定wrapper属性作为组件根元素');
                    return;
                }
                $(this.wrapper).addClass('gom-ui-select').html(this.makeScrollCtn());
            }
            this.setScroll();
            this.initSelect();
        },
        getScrollRoot: function(){
            return this.data.className ? $('.'+this.data.className) : $('.ui-scroll-select');
        },
        initSelect: function(){
            var $wrapper = this.getScrollRoot();
            for(var l=1; l&lt;=this.data.level; l++) {
                $wrapper.find('.ss-cell-'+l).find('li.table-view-cell').eq(0).addClass('active');
            }
        },
        //生成scroll-select所有的 htmlFragment;
        makeScrollCtn: function(){
            var level = this.data.level, scrollCtn='', levelDom = '';
            var initPadding = (this.data.yardNo-1)*33;
            for(var l=1; l&lt;=level; l++){
                levelDom = this.setListCont(l);
                scrollCtn += '&lt;div class="ui-scroll-select-item ui-scroll-select-' +l+'">&lt;div style="padding: '+ initPadding +'px 0;" class="ss-cell ss-cell-'+ l +'">'+levelDom+'&lt;/div>&lt;/div>';
            }
            var selectYard = '&lt;div class="ss-cell-yard" style="top: '+ initPadding +'px">&lt;/div>';
            return selectYard + '&lt;div class="ui-scroll-select ' + this.data.className + '">'+scrollCtn+'&lt;/div>';
        },

        //根据level生成列表 htmlFragment
        setListCont: function(level){
            var levelData = this.data.list[level], levelDataExt = [];
            for(var i=0; i&lt;levelData.length; i++){
                levelDataExt[i] = {};
                levelDataExt[i].title = levelData[i];
            }
            //console.log(levelDataExt, 'levelDataExt');
            var selectItem = {
                media: false,
                card: false,
                list: levelDataExt
            };

            return new List({
                data: selectItem
                //wrapper: '.ss-cell-'+level  //无wrapper时返回HTMLfragment
            }).render();
        },

        setScroll: function(){
            for(var l=1; l&lt;=this.data.level; l++){
                new Scroll({
                    step: 33,
                    speed: 0.5,
                    wrapper    : '.ui-scroll-select-'+l,    //滚动对象所在的容器
                    className  : '.ss-cell-'+l,      //滚动对象的className
                    endScroll: function(point){
                        console.log(point, 'point');
                        var step = this.getSteps();
                        this.$scroll.find('li.table-view-cell').removeClass('active').eq(step).addClass('active');
                    }
                });
            }
        },
        /**
         * 获取选择后的值;
         * @method Select#getSelect
         * @return 选择后的值
         */
        getSelect: function(){
            var $domRoot = this.getScrollRoot(), val, valArr = [];
            for(var l=1; l&lt;=this.data.level; l++) {
                val = $.trim($domRoot.find('.ss-cell-'+l).find('li.table-view-cell.active').text());
                valArr.push(val);
            }
            return valArr;
        }

    });
    return Select;
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.3</a> on Sun Dec 13 2015 23:01:03 GMT+0800 (CST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
